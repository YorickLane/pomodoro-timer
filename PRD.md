# PRD - 番茄钟（Pomodoro Timer）产品需求文档

## 1. 背景与目标

### 背景
- 现代人工作和学习时容易分心
- 需要一个简单有效的时间管理工具
- 番茄工作法被广泛验证有效
- 市场上的番茄钟 App 功能过于复杂或有广告

### 目标
- 提供一个简洁、无广告的番茄钟工具
- 帮助用户提高专注力和工作效率
- 数据本地存储，保护隐私
- 通过 App Store / Google Play 上架

---

## 2. 目标用户

- 学生（备考、写作业）
- 程序员、设计师（需要专注的脑力工作者）
- 自由职业者（需要自我管理）
- 所有需要提升专注力的人群

---

## 3. 核心场景

1. 早上开始工作，启动一个番茄钟
2. 25 分钟专注工作
3. 收到提醒，休息 5 分钟
4. 完成 4 个番茄钟后，长休息 15 分钟
5. 晚上查看今日完成了多少个番茄钟

---

## 4. 功能范围

### 4.1 MVP（首版必做）

**计时器**
- 标准番茄钟（25分钟工作 + 5分钟短休息）
- 长休息（15分钟，每4个番茄钟后）
- 暂停/恢复
- 跳过当前番茄钟
- 重置计时器

**通知提醒**
- 工作时间结束提醒
- 休息时间结束提醒
- 可关闭声音

**今日统计**
- 今日完成的番茄钟数量
- 总专注时长
- 完成率（目标 vs 实际）

**设置**
- 自定义时长（工作/短休息/长休息）
- 每日目标（番茄钟数量）
- 通知开关
- 声音开关

**数据记录**
- 每个番茄钟的记录（开始时间、完成状态）
- 今日历史列表
- 可删除记录

### 4.2 V1.1 可选增强

- 7日/30日统计图表
- 历史日历查看
- 任务标签（给番茄钟打标签：学习、工作、阅读等）
- 白噪音/专注音乐（可选）
- 连续专注天数统计
- 成就徽章系统
- 数据导出/导入

---

## 5. 非功能需求

- 离线可用、无需登录
- 启动时间 < 1.5s
- 数据本地持久化
- 计时精确（误差 < 1秒）
- iOS/Android 兼容主流版本
- 支持深色模式
- 流畅动画（60fps）

---

## 6. 功能优先级

### P0（必须有）
- ✅ 基础计时器（25/5/15 分钟）
- ✅ 通知提醒
- ✅ 今日统计
- ✅ 暂停/恢复/跳过

### P1（应该有）
- 自定义时长
- 每日目标设置
- 历史记录列表
- 深色模式

### P2（可以有）
- 7日统计图表
- 任务标签
- 白噪音

### P3（未来）
- 数据导出
- 桌面小组件
- Apple Watch

---

## 7. UI/UX 设计要点

### 主页面（计时器）
- 大的圆形倒计时器（视觉焦点）
- 当前状态清晰显示（工作中/休息中）
- 开始/暂停按钮显眼
- 今日完成数量显示

### 统计页面
- 今日完成的番茄钟数量
- 总专注时长
- 完成率百分比
- 历史记录列表

### 设置页面
- 时长设置（工作/短休息/长休息）
- 每日目标设置
- 通知和声音开关
- 关于和隐私政策

---

## 8. 数据模型

### 番茄钟记录
```typescript
interface PomodoroSession {
  id: string;
  type: 'work' | 'short_break' | 'long_break';
  duration_minutes: number;
  start_time: number;
  end_time: number;
  completed: boolean;
  date_key: string; // YYYY-MM-DD
  label?: string; // 可选标签
}
```

### 应用设置
```typescript
interface AppSettings {
  work_duration: number;        // 默认 25
  short_break_duration: number; // 默认 5
  long_break_duration: number;  // 默认 15
  daily_goal: number;           // 默认 8
  notification_enabled: boolean;
  sound_enabled: boolean;
  auto_start_break: boolean;    // 自动开始休息
  auto_start_work: boolean;     // 自动开始工作
}
```

---

## 9. 技术要求

### 必需
- Expo + React Native + TypeScript
- 本地存储（SQLite/IndexedDB）
- 通知系统
- 精确计时（setInterval + 时间校准）

### 推荐
- Zustand（状态管理）
- React Native Reanimated（动画）
- expo-router（路由）
- date-fns（日期处理）

---

## 10. 风险与规避

### 技术风险
- **计时不准确**
  - 使用 Date.now() 而不是 setTimeout 累加
  - 每秒校准时间

- **后台计时问题**
  - App 切到后台时暂停？还是继续？
  - 建议：继续计时，用户回来时更新状态

- **通知权限**
  - 引导用户开启权限
  - 提供友好的提示

### 产品风险
- **过于简单**
  - 突出"简洁"作为卖点
  - 强调无广告、隐私保护

- **竞品多**
  - 差异化：最简洁、最美观、完全离线
  - 强调用户体验和设计

---

## 11. 成功指标

### 功能完成度
- MVP 功能 100% 实现
- 核心流程无 bug
- 通知准时触发

### 质量指标
- 计时误差 < 1 秒
- 崩溃率 < 0.1%
- TypeScript 覆盖 100%

### 用户体验
- 启动时间 < 1.5s
- 操作流畅（60fps）
- 深色模式完美

---

## 12. 版本规划

### V1.0（首版）
- 基础番茄钟功能
- 今日统计
- 设置
- 深色模式

### V1.1
- 7日统计图表
- 任务标签
- 历史查看

### V1.2
- 白噪音
- 数据导出
- 成就系统

### V2.0
- 桌面小组件
- Apple Watch
- 多设备同步（可选）

---

**简单、专注、高效 - 这就是番茄钟的核心！** 🍅
