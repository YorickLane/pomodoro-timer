# åº”ç”¨åŒ…å¤§å°ä¼˜åŒ–æŒ‡å— - App Size Optimization

## ğŸ“Š å½“å‰çŠ¶æ€åˆ†æ

**æ„å»ºæ–‡ä»¶å¤§å°ï¼š** ~90 MB
**é¢„è®¡ä¸‹è½½å¤§å°ï¼š** ~20-40 MBï¼ˆApp Store ä¼˜åŒ–åï¼‰
**è¯„ä¼°ï¼š** âœ… æ­£å¸¸èŒƒå›´

> **é‡è¦ï¼š** æ„å»ºæ–‡ä»¶ï¼ˆ.ipa/.apkï¼‰è¿œå¤§äºç”¨æˆ·å®é™…ä¸‹è½½å¤§å°ï¼

---

## ğŸ¯ åŒ…å¤§å°çœŸç›¸

### æ„å»ºæ–‡ä»¶ vs ä¸‹è½½å¤§å°

| ç±»å‹ | å¤§å° | è¯´æ˜ |
|------|------|------|
| æ„å»ºæ–‡ä»¶ï¼ˆ.ipa/.apkï¼‰ | 90 MB | åŒ…å«æ‰€æœ‰å¹³å°å’Œæ¶æ„ä»£ç  |
| **ç”¨æˆ·ä¸‹è½½** | **20-40 MB** | App Store ä¼˜åŒ–ï¼Œåªä¸‹è½½å¿…éœ€éƒ¨åˆ† |
| å®‰è£…åå¤§å° | 50-80 MB | è§£å‹ååœ¨è®¾å¤‡ä¸Šçš„å¤§å° |

**ç»“è®ºï¼šç”¨æˆ·å®é™…ä¸‹è½½åªæœ‰æ„å»ºæ–‡ä»¶çš„ 30-50%ï¼**

### ä¸ºä»€ä¹ˆæ„å»ºæ–‡ä»¶è¿™ä¹ˆå¤§ï¼Ÿ

#### 1. React Native æ ¸å¿ƒï¼ˆ~30-40 MBï¼‰
- JavaScript å¼•æ“ï¼ˆHermesï¼Œå·²ä¼˜åŒ–ï¼‰
- React Native æ¡†æ¶
- åŸç”Ÿæ¡¥æ¥ä»£ç 

#### 2. Expo SDK æ¨¡å—ï¼ˆ~20-30 MBï¼‰
å½“å‰ä½¿ç”¨çš„æ¨¡å—ï¼š
```json
expo-router          # è·¯ç”±ç³»ç»Ÿ
expo-sqlite          # æ•°æ®åº“
expo-notifications   # é€šçŸ¥
expo-localization    # å›½é™…åŒ–
expo-haptics         # è§¦è§‰åé¦ˆ
expo-splash-screen   # å¯åŠ¨é¡µ
```

#### 3. UI å’ŒåŠ¨ç”»åº“ï¼ˆ~15-20 MBï¼‰
```json
react-native-reanimated      # åŠ¨ç”»å¼•æ“ï¼ˆè¾ƒå¤§ï¼‰
react-native-svg             # SVG æ”¯æŒ
react-native-gifted-charts   # å›¾è¡¨åº“
@expo/vector-icons           # å›¾æ ‡åº“ï¼ˆåŒ…å«å¤šå¥—å›¾æ ‡ï¼‰
```

#### 4. å¤šæ¶æ„æ”¯æŒï¼ˆ~10-20 MBï¼‰
- ARM64ï¼ˆç°ä»£è®¾å¤‡ï¼‰
- ARMv7ï¼ˆæ—§è®¾å¤‡ï¼‰
- x86ï¼ˆæ¨¡æ‹Ÿå™¨ï¼‰

#### 5. å›½é™…åŒ–èµ„æº
- i18next è¿è¡Œæ—¶
- è¯­è¨€æ–‡ä»¶ï¼ˆè™½ç„¶å¾ˆå°ï¼‰

---

## ğŸ“ è¡Œä¸šæ ‡å‡†å¯¹æ¯”

### å…¸å‹åº”ç”¨å¤§å°

| åº”ç”¨ç±»å‹ | ä¸‹è½½å¤§å° | è¯´æ˜ |
|---------|---------|------|
| æœ€å° Expo ç©ºç™½åº”ç”¨ | 4 MB | ä»…æ ¸å¿ƒæ¡†æ¶ |
| ç®€å•å·¥å…·åº”ç”¨ | 20-40 MB | **æˆ‘ä»¬çš„åº”ç”¨** âœ… |
| ä¸­ç­‰åŠŸèƒ½åº”ç”¨ | 50-100 MB | å›¾è¡¨ã€åœ°å›¾ç­‰ |
| å¤æ‚åº”ç”¨ | 100-300 MB | æ¸¸æˆã€è§†é¢‘ç­‰ |

**å‚è€ƒæ•°æ®ï¼ˆApp Store ä¸‹è½½å¤§å°ï¼‰ï¼š**
- å¾®ä¿¡ï¼š~250 MB
- æ”¯ä»˜å®ï¼š~150 MB
- ç®€å•è®¡æ—¶å™¨åº”ç”¨ï¼š15-40 MB
- **æˆ‘ä»¬çš„ç•ªèŒ„é’Ÿï¼š** é¢„è®¡ 20-40 MB âœ…

### ç»“è®º

**90 MB æ„å»ºæ–‡ä»¶ = 20-40 MB ä¸‹è½½å¤§å° = âœ… å®Œå…¨æ­£å¸¸**

---

## ğŸš€ ä¼˜åŒ–å»ºè®®

### âœ… å·²ç»åšå¯¹çš„äº‹æƒ…

1. **Hermes å¼•æ“** - Expo SDK 54 é»˜è®¤å¯ç”¨
   - âœ… æ›´å°çš„äºŒè¿›åˆ¶å¤§å°
   - âœ… æ›´å¿«çš„å¯åŠ¨é€Ÿåº¦
   - âœ… æ›´ä½çš„å†…å­˜å ç”¨

2. **åˆç†çš„ä¾èµ–**
   - âœ… åªä½¿ç”¨å¿…éœ€çš„åº“
   - âœ… æ²¡æœ‰ä¸å¿…è¦çš„å¤§å‹ä¾èµ–

3. **ä»£ç è´¨é‡**
   - âœ… TypeScriptï¼ˆç¼–è¯‘æ—¶ä¼˜åŒ–ï¼‰
   - âœ… æ— æœªä½¿ç”¨çš„ä»£ç 

### ğŸ¯ å¯ä»¥ä¼˜åŒ–çš„åœ°æ–¹

#### ä¼˜å…ˆçº§ 1ï¼šç§»é™¤æœªä½¿ç”¨çš„ä¾èµ–

**æ£€æŸ¥æœªä½¿ç”¨çš„åŒ…ï¼š**
```bash
npx depcheck
```

**å¯èƒ½å¯ä»¥ç§»é™¤çš„ï¼š**
- `react-native-gifted-charts` - å¦‚æœå½“å‰ç‰ˆæœ¬æ²¡ç”¨åˆ°å›¾è¡¨
- æ£€æŸ¥æ˜¯å¦æœ‰å…¶ä»–æœªä½¿ç”¨çš„åŒ…

#### ä¼˜å…ˆçº§ 2ï¼šå›¾æ ‡åº“ä¼˜åŒ–

**é—®é¢˜ï¼š** `@expo/vector-icons` åŒ…å«å¤šå¥—å›¾æ ‡ï¼ˆMaterial, Ionicons, FontAwesome ç­‰ï¼‰ï¼Œä½†æˆ‘ä»¬åªç”¨äº† Ionicons

**ä¼˜åŒ–æ–¹æ³•ï¼ˆv2.0 æ—¶è€ƒè™‘ï¼‰ï¼š**
```json
// ä½¿ç”¨å•ç‹¬çš„å›¾æ ‡åŒ…
"@expo/vector-icons": "^15.0.3"
// æ”¹ä¸ºåªå¯¼å…¥éœ€è¦çš„ï¼š
"react-native-vector-icons": "^10.0.0"
```

**é¢„è®¡å‡å°‘ï¼š** ~5-10 MB

#### ä¼˜å…ˆçº§ 3ï¼šæ˜ç¡®å¯ç”¨ Hermesï¼ˆç¡®ä¿ä¼˜åŒ–ï¼‰

**åœ¨ app.json ä¸­æ·»åŠ ï¼š**
```json
{
  "expo": {
    "jsEngine": "hermes",
    "android": {
      "jsEngine": "hermes"
    },
    "ios": {
      "jsEngine": "hermes"
    }
  }
}
```

è™½ç„¶é»˜è®¤å°±æ˜¯ Hermesï¼Œä½†æ˜ç¡®é…ç½®æ›´ä¿é™©ã€‚

#### ä¼˜å…ˆçº§ 4ï¼šèµ„æºä¼˜åŒ–

**æ£€æŸ¥èµ„æºæ–‡ä»¶ï¼š**
```bash
# æŸ¥çœ‹ assets ç›®å½•å¤§å°
du -sh assets/

# ä¼˜åŒ–å›¾ç‰‡
# ä½¿ç”¨ ImageOptim æˆ– tinypng.com å‹ç¼©å›¾ç‰‡
```

#### ä¼˜å…ˆçº§ 5ï¼šç”Ÿäº§æ„å»ºä¼˜åŒ–

**åœ¨ eas.json ä¸­æ·»åŠ ï¼š**
```json
{
  "build": {
    "production": {
      "env": {
        "EXPO_PUBLIC_ENV": "production"
      },
      "android": {
        "buildType": "apk",
        "gradleCommand": ":app:assembleRelease"
      },
      "ios": {
        "buildConfiguration": "Release"
      }
    }
  }
}
```

---

## ğŸ“¦ å®é™…æµ‹é‡æ–¹æ³•

### æ–¹æ³• 1ï¼šæŸ¥çœ‹ EAS Build æŠ¥å‘Š

```bash
# æ„å»ºåï¼Œåœ¨ EAS ç½‘ç«™æŸ¥çœ‹
# https://expo.dev/accounts/[your-account]/projects/pomodoro-timer/builds

# ä¼šæ˜¾ç¤ºï¼š
# - Build sizeï¼ˆæ„å»ºå¤§å°ï¼‰
# - Estimated download sizeï¼ˆé¢„è®¡ä¸‹è½½å¤§å°ï¼‰
```

### æ–¹æ³• 2ï¼šä½¿ç”¨ Expo Atlasï¼ˆæ¨èï¼‰

```bash
# åˆ†æ JavaScript bundle å¤§å°
npx expo-atlas

# ä¼šæ˜¾ç¤ºï¼š
# - å“ªäº›åº“å ç”¨æœ€å¤§
# - æ˜¯å¦æœ‰é‡å¤ä¾èµ–
# - æœªä½¿ç”¨çš„ä»£ç 
```

### æ–¹æ³• 3ï¼šApp Store / Google Play

**æœ€å‡†ç¡®çš„æµ‹é‡ï¼š**
- ä¸Šä¼ åˆ° TestFlight åï¼Œåœ¨ Build Metadata æŸ¥çœ‹
- ä¸Šä¼ åˆ° Google Play åï¼Œåœ¨æ§åˆ¶å°æŸ¥çœ‹ä¸‹è½½å¤§å°

---

## ğŸ” æ·±åº¦åˆ†æï¼ˆå¯é€‰ï¼‰

### Android APK åˆ†æ

```bash
# 1. æ„å»º APK
eas build --platform android

# 2. ä¸‹è½½ APK
eas build:download --platform android --output ./app.apk

# 3. ä½¿ç”¨ Android Studio åˆ†æ
# Android Studio > Build > Analyze APK
# ä¼šæ˜¾ç¤ºæ¯ä¸ªéƒ¨åˆ†çš„å¤§å°
```

### iOS IPA åˆ†æ

```bash
# 1. ä¸‹è½½ IPA
eas build:download --platform ios --output ./app.ipa

# 2. é‡å‘½åä¸º .zip å¹¶è§£å‹
mv app.ipa app.zip
unzip app.zip

# 3. æŸ¥çœ‹ Payload ç›®å½•å¤§å°
du -sh Payload/
```

---

## âš¡ ç»ˆæä¼˜åŒ–æ–¹æ¡ˆ

### å¦‚æœå¿…é¡»è¿›ä¸€æ­¥å‡å°ï¼ˆ< 50 MBï¼‰

#### 1. ç§»é™¤å›¾è¡¨åº“
```bash
# å¦‚æœä¸éœ€è¦ç»Ÿè®¡å›¾è¡¨ï¼ˆå½“å‰ç‰ˆæœ¬ç¡®å®æ²¡ç”¨ï¼‰
npm uninstall react-native-gifted-charts

# é¢„è®¡å‡å°‘ï¼š~8-10 MB
```

#### 2. ä½¿ç”¨æŒ‰éœ€å¯¼å…¥

**ä¼˜åŒ–å‰ï¼š**
```typescript
import { Ionicons } from '@expo/vector-icons';
```

**ä¼˜åŒ–åï¼ˆv2.0 è€ƒè™‘ï¼‰ï¼š**
```typescript
// åªå¯¼å…¥éœ€è¦çš„å›¾æ ‡
import Ionicons from 'react-native-vector-icons/Ionicons';
```

#### 3. ä»£ç åˆ†å‰²ï¼ˆWebï¼‰

å¯¹äº Web ç‰ˆæœ¬ï¼Œå¯ä»¥ä½¿ç”¨ä»£ç åˆ†å‰²ï¼š
```typescript
// åŠ¨æ€å¯¼å…¥å¤§å‹ç»„ä»¶
const StatsScreen = lazy(() => import('./stats'));
```

#### 4. ç§»é™¤æœªä½¿ç”¨çš„ Expo æ¨¡å—

æ£€æŸ¥æ˜¯å¦æ‰€æœ‰é…ç½®çš„æ’ä»¶éƒ½åœ¨ä½¿ç”¨ï¼š
```json
"plugins": [
  "expo-router",      // âœ… ä½¿ç”¨ä¸­
  "expo-sqlite",      // âœ… ä½¿ç”¨ä¸­
  "expo-localization" // âœ… ä½¿ç”¨ä¸­
]
```

---

## ğŸ“‹ ä¼˜åŒ–æ£€æŸ¥æ¸…å•

### ç«‹å³å¯åšï¼ˆæ¨èï¼‰

- [x] âœ… Hermes å¼•æ“å·²å¯ç”¨ï¼ˆé»˜è®¤ï¼‰
- [ ] è¿è¡Œ `npx depcheck` æ£€æŸ¥æœªä½¿ç”¨çš„ä¾èµ–
- [ ] è¿è¡Œ `npx expo-atlas` åˆ†æ JS bundle
- [ ] æ£€æŸ¥å¹¶å‹ç¼© assets èµ„æºæ–‡ä»¶
- [ ] æ˜ç¡®é…ç½® Hermes åœ¨ app.json

### è€ƒè™‘åšï¼ˆå¦‚æœéœ€è¦ < 50 MBï¼‰

- [ ] ç§»é™¤ react-native-gifted-chartsï¼ˆå½“å‰æœªä½¿ç”¨ï¼‰
- [ ] ä¼˜åŒ–å›¾æ ‡å¯¼å…¥æ–¹å¼
- [ ] ä½¿ç”¨ ProGuardï¼ˆAndroidï¼‰
- [ ] åˆ†æå¹¶ç§»é™¤æœªä½¿ç”¨çš„åŸç”Ÿä»£ç 

### ä¸æ¨èåš

- âŒ ç§»é™¤ Reanimatedï¼ˆä¼šå½±å“åŠ¨ç”»æ€§èƒ½ï¼‰
- âŒ ç§»é™¤ SQLiteï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰
- âŒ é™çº§ Expo SDKï¼ˆä¼šå¤±å»ä¼˜åŒ–ï¼‰

---

## ğŸ¯ å®é™…è¡ŒåŠ¨å»ºè®®

### å½“å‰çŠ¶æ€ï¼šæ— éœ€ä¼˜åŒ– âœ…

**ç†ç”±ï¼š**
1. 90 MB æ„å»ºæ–‡ä»¶ â†’ å®é™…ä¸‹è½½çº¦ 20-40 MB
2. åœ¨è¡Œä¸šæ ‡å‡†èŒƒå›´å†…
3. æ‰€æœ‰ä¾èµ–éƒ½æ˜¯å¿…éœ€çš„ï¼ˆé™¤äº†å¯èƒ½çš„ gifted-chartsï¼‰
4. Hermes å·²å¯ç”¨ï¼Œå·²æ˜¯æœ€ä¼˜é…ç½®

### å¦‚æœä¸€å®šè¦ä¼˜åŒ–

**æ¨èæ­¥éª¤ï¼š**

1. **æ£€æŸ¥æœªä½¿ç”¨çš„ä¾èµ–**
   ```bash
   npx depcheck
   ```

2. **åˆ†æ JS bundle**
   ```bash
   npx expo-atlas
   ```

3. **ç§»é™¤ gifted-chartsï¼ˆå¦‚æœæœªä½¿ç”¨ï¼‰**
   ```bash
   npm uninstall react-native-gifted-charts
   # é¢„è®¡å‡å°‘ 8-10 MB
   ```

4. **æ˜ç¡®å¯ç”¨ Hermes**
   ```json
   // app.json
   {
     "expo": {
       "jsEngine": "hermes"
     }
   }
   ```

5. **é‡æ–°æ„å»ºå¹¶æµ‹é‡**
   ```bash
   eas build --platform all
   ```

---

## ğŸ“± çœŸå®ä¸‹è½½å¤§å°éªŒè¯

**æœ€å‡†ç¡®çš„æ–¹æ³•ï¼š**

### iOS
1. ä¸Šä¼ åˆ° TestFlight
2. åœ¨ App Store Connect æŸ¥çœ‹
3. Build Metadata æ ‡ç­¾ä¼šæ˜¾ç¤ºçœŸå®ä¸‹è½½å¤§å°

### Android
1. ä¸Šä¼ åˆ° Google Play
2. åœ¨ Release Dashboard æŸ¥çœ‹
3. ä¼šæ˜¾ç¤ºä¸åŒè®¾å¤‡çš„ä¸‹è½½å¤§å°

**é¢„è®¡ç»“æœï¼š**
- iOS: 25-35 MB
- Android: 20-30 MBï¼ˆå–å†³äºè®¾å¤‡æ¶æ„ï¼‰

---

## ğŸ† è¡Œä¸šå¯¹æ¯”

**åŒç±»åº”ç”¨å‚è€ƒï¼š**
- Forestï¼ˆä¸“æ³¨æ£®æ—ï¼‰ï¼š~50 MB
- Tideï¼ˆæ½®æ±ï¼‰ï¼š~80 MB
- Focus Timerï¼ˆå„ç±»ï¼‰ï¼š20-60 MB
- **æˆ‘ä»¬çš„ç•ªèŒ„é’Ÿï¼š** ~90 MB æ„å»º â†’ ~30 MB ä¸‹è½½ âœ…

**ç»“è®ºï¼šå®Œå…¨åœ¨åˆç†èŒƒå›´å†…ï¼Œç”šè‡³åå°ï¼**

---

## ğŸ’¡ æ€»ç»“

### å…³é”®è®¤çŸ¥

1. **æ„å»ºæ–‡ä»¶ â‰  ä¸‹è½½å¤§å°**
   - 90 MB æ„å»ºæ–‡ä»¶
   - å®é™…ä¸‹è½½å¯èƒ½åªæœ‰ 20-40 MB

2. **React Native åº”ç”¨å¤©ç„¶è¾ƒå¤§**
   - åŒ…å«å®Œæ•´çš„ JS å¼•æ“
   - åŒ…å«åŸç”Ÿæ¡†æ¶
   - è¿™æ˜¯æŠ€æœ¯ç‰¹æ€§ï¼Œä¸æ˜¯é—®é¢˜

3. **ç”¨æˆ·ä½“éªŒä¸å—å½±å“**
   - ä¸‹è½½å¤§å°åˆç†
   - å¯åŠ¨é€Ÿåº¦å¿«ï¼ˆHermesï¼‰
   - è¿è¡Œæµç•…

### æ¨èè¡ŒåŠ¨

**ç°é˜¶æ®µï¼š** æ— éœ€ä¼˜åŒ– âœ…
- å½“å‰å¤§å°å®Œå…¨æ­£å¸¸
- ç”¨æˆ·ä¸‹è½½ä½“éªŒè‰¯å¥½
- æ‰€æœ‰ä¾èµ–éƒ½æ˜¯å¿…éœ€çš„

**æœªæ¥ä¼˜åŒ–ï¼ˆV2.0+ï¼‰ï¼š**
- å¦‚æœæ·»åŠ äº†æ–°åŠŸèƒ½å¯¼è‡´åŒ…å¢å¤§
- ä½¿ç”¨ Expo Atlas åˆ†æå…·ä½“å ç”¨
- é’ˆå¯¹æ€§ä¼˜åŒ–å¤§å‹ä¾èµ–

### å‚è€ƒæ–‡æ¡£

- Expo App Size: https://docs.expo.dev/distribution/app-size/
- Hermes Engine: https://docs.expo.dev/guides/using-hermes/
- æŸ¥è¯¢æ—¶é—´ï¼š2025-11-23ï¼ˆæœ€æ–°ï¼‰

---

**ä¸è¦è¿‡åº¦ä¼˜åŒ–ï¼å½“å‰å¤§å°å®Œå…¨åˆç†ï¼Œä¸“æ³¨äºåŠŸèƒ½å’Œç”¨æˆ·ä½“éªŒæ›´é‡è¦ã€‚** ğŸ¯
